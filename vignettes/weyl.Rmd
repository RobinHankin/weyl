---
title: "Quantum algebra with R: the weyl package"
author: "Robin K. S. Hankin"
date: "`r Sys.Date()`"
vignette: >
  %\VignetteIndexEntry{The weyl package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

<p style="text-align: right;">
![](`r system.file("help/figures/weyl.png", package = "weyl")`){width=10%}
</p>

# The first Weyl algebra

Consider the vector space ${\mathcal A}$ of linear operators on
univariate functions; ${\mathcal A}$ can be made into an algebra where
multiplication (denoted by juxtaposition) is defined as operator
composition:

\[({\mathcal O}_1{\mathcal O}_2)f={\mathcal O}_1({\mathcal O}_2f)\]

We consider the algebra generated by by $\partial\colon
f\longrightarrow f'$ [that is, $(\partial f)(x) = f'(x)$] and $x\colon
f\longrightarrow xf$ [that is, $(xf)(x) = xf(x)$].  This is known as
the (first) Weyl algebra.  We observe that the Weyl algebra is not
commutative: $\partial xf=(xf)'=f+xf'$ but $x\partial f=xf'$, so
$\partial x=x\partial+1$.  The algebra generated by $\left\lbrace
x,\partial\right\rbrace$ will include elements such as $7\partial +
4\partial x\partial^3 x$, which would map $f$ to $7f' +
4\left(x\left(xf\right)'''\right)'$.

It can be shown that any element of the Weyl algebra can be expressed
in the standard form

\[
\sum a_i \partial^{p_i}x^{q_i}\]

for real $a_i$ and nonnegative integers $p_i,q_i$.  Converting a
general word to standard form is not straightforward but we have

\[
\partial x^n = x^n\partial +  nx^{n-1}\]

and

\[
\partial^n x = x\partial^n +  n\partial^{n-1}.\]

We can apply these rules recursively to find standard form for
products $(\partial^i x^j)(\partial^l x^m)$.  Alternatively we may
follow Cock and use the fact that

\[
(\partial^i x^j)(\partial^lx^m)=
\sum_{r=0}^j{j\choose r}{l\choose r}\partial^{i+l-r}x^{j+m-r}\]

All this is done in the package.  Consider $d_1=\partial x +
2\partial^3$ and $d_2=3+7\partial -5x^2\partial^2$.  Observing
that $d_1$ is in standard form, package idiom would be:

```{r loadlib,echo=TRUE,print=FALSE,results="hide",message=FALSE}
library(weyl)
```		

```{r defineandprintd1d2}
d1 <- weyl(spray(rbind(c(1,1),c(0,3)),c(1,2)))
d2 <- weyl(spray(rbind(c(0,0),c(1,0),c(2,2)),c(3,7,-5)))
d1
d2
```

Observe that, like the `spray` package, the order of the matrix rows
is not defined.  We may apply the usual rules of arithmetic to these
objects:

```{r showmultiplication}
d1*d2
```

We may choose to display  results in symbolic form:

```{r showinpolyform}
options(polyform=TRUE)
(d1^2 + d2) * (d2 - 3*d1)
```

# Further Weyl algebras

The package supports multivariate Weyl algebras.  Consider:


```{r showmultivariateweyl}
options(polyform=FALSE)  # revert to default print method
set.seed(0)
x <- rweyl()
x
```

Above, object `x` is a member of the operator algebra generated by
$\left\lbrace\partial_x,\partial_y,\partial_z,x,y,z\right\rbrace$.
We may verify associativity of multiplication:

```{r associativityisnontrivial}
x <- rweyl(n=1,d=2)
y <- rweyl(n=2,d=2)
z <- rweyl(n=3,d=2)
x*(y*z)
(x*y)*z
```

Comparing the two results above, we see that they apparently differ.
But the apparent difference is due to the fact that the lines appear
in a different order, a feature that is not algebraically meaningful.
We may verify that the expressions are indeed algebraically identical:

```{r verifyassociativity}
x*(y*z) - (x*y)*z
```

# Derivations

A _derivation_ $D$ of an algebra ${\mathcal A}$ is a linear operator
that satisfies $D(d_1d_2)=d_1D(d_2) + D(d_1)d_2$, for every
$d_1,d_2\in{\mathcal A}$.  If a derivation is of the form $D(d) =
[d,f] = df-fd$ for some fixed $f\in{\mathcal A}$, we say that $D$ is
an _inner_ derivation:

\[
D(d_1d_2) =
d_1d_2f-fd_1d_2 =
d_1d_2f-d_1fd_2 + d_1fd_2-fd_1d_2 = 
d_1(d_2f-fd_2) + (d_1f-fd_1)d_2 =
d_1D(d_2) + D(d_1)d_2
\]

Dirac showed that all derivations are inner derivations for some
$f\in{\mathcal A}$.  The package supports derivations:

```{r define_derivation_D}
f <- rweyl()
D <- as.der(f)  # D(x) = xf-fx
```

Then

```{r show_D_is_a_derivation}
d1 <- rweyl()
d2 <- rweyl()
D(d1*d2) == d1*D(d2) + D(d1)*d2
```



## References

* S. C. Coutinho 1997.  _The many avatars of a simple algebra_.  The
   American Mathematical Monthly, 104(7):593-604.  DOI
   [https://doi.org/10.1080/00029890.1997.11990687](https://doi.org/10.1080/00029890.1997.11990687).
