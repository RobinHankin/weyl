---
title: "Lie algebras and differential operators"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library("weyl")
set.seed(0)
```


<p style="text-align: right;">
![](`r system.file("help/figures/weyl.png", package = "weyl")`){width=10%}
</p>

A very nice youtube video by Borcherds
[here](https://www.youtube.com/watch?v=xVbfWunObYQ&ab_channel=RichardE.BORCHERDS)
discusses the fact that first-order differential operators do not
quite commute, but their commutator is itself first-order.
Symbolically, if

$$
D=\sum f_i\left(x_1,\dots,x_n\right)\frac{\partial}{\partial x_i}\qquad
E=\sum g_i\left(x_1,\dots,x_n\right)\frac{\partial}{\partial x_i}
$$

where $f_i=f_i\left(x_1,\dots,x_n\right)$ and
$g_i=g_i\left(x_1,\dots,x_n\right)$ are functions,
then

$$
DE=\sum_{i,j}f_i\frac{\partial}{\partial x_i}\,g_i\frac{\partial}{\partial x_j}
=\sum_{i,j}f_ig_j\frac{\partial}{\partial x_i}\frac{\partial}{\partial x_j} +
f_i\frac{\partial g_j}{\partial x_i}\,\frac{\partial}{\partial x_j}
$$

$$
ED=\sum_{i,j}g_i\frac{\partial}{\partial x_i}\,f_i\frac{\partial}{\partial x_j}
=\sum_{i,j}g_if_j\frac{\partial}{\partial x_j}\frac{\partial}{\partial x_i} +
g_i\frac{\partial f_i}{\partial x_j}\,\frac{\partial}{\partial x_j}
$$

so $E$ and $E$ ``nearly'' commute, in the sense that $ED-DE$ is _first
order_:

$$DE-ED=
\sum_{i,j}f_i\frac{\partial g_j}{\partial x_i}\,\frac{\partial}{\partial
x_j}-g_i\frac{\partial f_i}{\partial x_j}\,\frac{\partial}{\partial
x_j}
$$

Above we have used the fact that partial derivatives commute, whence
the cancellation of the second-order terms.

We can verify this using the `weyl` package:

```{r}
D <- as.weyl(spray(cbind(matrix(sample(1:9),3,3),matrix(c(0,1,0,1,0,0,0,0,1),3,3,byrow=T)),1:3))
E <- as.weyl(spray(cbind(matrix(sample(1:9),3,3),matrix(c(0,1,0,1,0,0,0,0,1),3,3,byrow=T)),1:3))
F <- as.weyl(spray(cbind(matrix(sample(1:9),3,3),matrix(c(0,1,0,1,0,0,0,0,1),3,3,byrow=T)),1:3))
D
```

($E$ and $F$ are similar).  Symbolically we would have


$$D=
x_1^9x_2^1x_3^3\frac{\partial}{\partial x_1}+
x_1^4x_2^2x_3^8\frac{\partial}{\partial x_2}+
x_1^9x_2^6x_3^5\frac{\partial}{\partial x_3}
$$

or, easier on the eye:

$$D=
x^9y^1z^3\frac{\partial}{\partial x}+
x^4y^2z^8\frac{\partial}{\partial y}+
x^7y^6z^5\frac{\partial}{\partial z}
$$

(and similarly for $E$).  Then to calculate $ED-DE$:


```{r}
E*D-D*E
```

and we see that the Lie bracket is indeed first order.

```{r}
.[E,D]
```

Jacobi's identity?


```{r,verifyjacobi,cache=TRUE}
F <- as.weyl(spray(cbind(matrix(sample(1:9),3,3),matrix(c(0,1,0,1,0,0,0,0,1),3,3,byrow=T)),1:3))
.[D,.[E,F]] + .[F,.[D,E]] + .[E,.[F,D]]
```

Borcherds goes on to consider the special case where the $f_i$ and
$g_i$ are constant and shows that these guys commute, so their Lie
bracket is identically zero:

```{r,abelianshow,cache=TRUE}
(D <- as.weyl(spray(cbind(matrix(0,3,3),matrix(c(0,1,0,1,0,0,0,0,1),3,3,byrow=T)),1:3)))
(E <- as.weyl(spray(cbind(matrix(0,3,3),matrix(c(0,1,0,1,0,0,0,0,1),3,3,byrow=T)),5:7)))
.[D,E]
```